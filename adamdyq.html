<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ахмет Байтұрсынұлы - Интерактивті тест</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --accent: #1e3799;
            --gold: #d4af37;
            --correct: #27ae60;
            --wrong: #c0392b;
            --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        * {
            box-sizing: border-box;
            user-select: none;
        }

        body {
            font-family: 'Nunito', sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: var(--bg-gradient);
            overflow-x: hidden;
            position: relative;
        }

        /* Ою-өрнек фоны */
        body::before, body::after {
            content: "";
            position: fixed;
            width: 300px;
            height: 300px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50 0 C60 20 90 20 100 50 C80 60 80 90 50 100 C40 80 10 80 0 50 C20 40 20 10 50 0" fill="none" stroke="%23d4af37" stroke-width="1" opacity="0.2"/></svg>');
            background-size: contain;
            z-index: -1;
        }

        body::before { top: -50px; left: -50px; transform: rotate(15deg); }
        body::after { bottom: -50px; right: -50px; transform: rotate(-165deg); }

        #quiz-container {
            background: rgba(255, 255, 255, 0.95);
            width: 95%;
            max-width: 800px;
            padding: 40px;
            border-radius: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            text-align: center;
            position: relative;
            border: 8px double var(--gold);
        }

        .ornament-corner {
            position: absolute;
            width: 60px;
            height: 60px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" fill="%23d4af37"><path d="M0 0 L100 0 L100 20 C100 20 40 20 20 40 C20 60 20 100 20 100 L0 100 Z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
        }
        .top-left { top: 10px; left: 10px; }
        .top-right { top: 10px; right: 10px; transform: rotate(90deg); }
        .bottom-left { bottom: 10px; left: 10px; transform: rotate(-90deg); }
        .bottom-right { bottom: 10px; right: 10px; transform: rotate(180deg); }

        #start-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: fadeIn 1s ease;
        }

        .cover-image {
            width: 100%;
            max-height: 400px;
            object-fit: contain;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 3px solid var(--gold);
            background: #fff;
        }

        .start-title {
            font-size: 2.4rem;
            font-weight: 900;
            color: var(--accent);
            margin: 10px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .start-desc {
            font-size: 1.2rem;
            color: #444;
            margin-bottom: 30px;
            max-width: 600px;
        }

        .btn-action {
            background: var(--gold);
            color: #fff;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: 900;
            border-radius: 50px;
            cursor: pointer;
            transition: 0.3s;
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 10px;
        }

        .btn-action:hover {
            transform: scale(1.05);
            background: #b8962e;
        }

        .btn-secondary {
            background: #7f8c8d;
            padding: 12px 30px;
            font-size: 1rem;
        }

        .header-section {
            display: none;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--gold);
            padding-bottom: 15px;
        }

        #timer-box {
            background: var(--accent);
            color: var(--gold);
            padding: 8px 20px;
            border-radius: 15px;
            font-weight: 900;
            font-size: 1.3rem;
            border: 2px solid var(--gold);
        }

        .question-text {
            font-size: 1.6rem;
            font-weight: 800;
            color: var(--accent);
            margin-bottom: 30px;
            min-height: 80px;
        }

        .options-grid {
            display: grid;
            gap: 15px;
        }

        .option {
            background: #fff;
            padding: 20px 30px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: 700;
            border: 2px solid #ddd;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: space-between;
            text-align: left;
        }

        .option:hover {
            border-color: var(--gold);
            background: #fffdf5;
        }

        .option.correct { background: var(--correct) !important; color: white; border-color: #1e8449; }
        .option.wrong { background: var(--wrong) !important; color: white; border-color: #922b21; pointer-events: none; opacity: 0.7; }

        .controls-area {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        #progress-container { display: none; margin-top: 40px; }
        .progress-bar { width: 100%; height: 15px; background: #eee; border-radius: 10px; overflow: hidden; border: 1px solid #ddd; }
        .progress-fill { height: 100%; width: 0%; background: var(--gold); transition: 0.5s; }

        #results { display: none; animation: fadeIn 0.8s ease; }
        .score-display { font-size: 4rem; font-weight: 900; color: var(--gold); margin: 20px 0; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<div id="quiz-container">
    <div class="ornament-corner top-left"></div>
    <div class="ornament-corner top-right"></div>
    <div class="ornament-corner bottom-left"></div>
    <div class="ornament-corner bottom-right"></div>

    <div id="start-screen">
        <img src="image_f2bdaa.png" alt="Ахмет Байтұрсынұлы" class="cover-image" onerror="this.src='https://via.placeholder.com/600x400?text=Ахмет+Байтұрсынұлы'">
        <h1 class="start-title">Ахмет Байтұрсынұлы</h1>
        <p class="start-desc">«Адамдық диқаншысы» өлеңі және ақын шығармашылығы бойынша интерактивті тест.</p>
        <button class="btn-action" onclick="startQuiz()">Бастау</button>
    </div>

    <div id="quiz-header" class="header-section">
        <h2 style="margin:0; color: var(--accent);">Сұрақ №<span id="q-num">1</span></h2>
        <div id="timer-box">01:20</div>
    </div>

    <div id="quiz-view"></div>

    <div id="controls" class="controls-area" style="display: none;">
        <button id="back-btn" class="btn-action btn-secondary" onclick="goBack()" style="visibility: hidden;">◀ Артқа</button>
    </div>

    <div id="progress-container">
        <div class="progress-bar">
            <div id="progress-fill" class="progress-fill"></div>
        </div>
        <p style="font-weight: bold; margin-top: 10px; color: var(--accent);">Жалпы: 10 сұрақ</p>
    </div>

    <div id="results">
        <h2 class="start-title">Тест аяқталды!</h2>
        <div class="score-display"><span id="final-score">0</span> / 10</div>
        <p id="result-text" style="font-size: 1.2rem; margin-bottom: 30px; font-weight: bold;"></p>
        <button class="btn-action" onclick="location.reload()">Қайта тапсыру</button>
    </div>
</div>

<script>
    const questions = [
        { q: "«Адамдық диқаншысы» өлеңінің авторы кім?", o: ["Шәкәрім Құдайбердіұлы", "Ахмет Байтұрсынұлы", "Мағжан Жұмабаев", "Міржақып Дулатов"], a: 1 },
        { q: "Өлеңдегі «диқаншы» бейнесі кімді меңзейді?", o: ["Егін егетін адамды", "Халықты оятатын ағартушыны", "Мал бағатын адамды", "Саясаткерді"], a: 1 },
        { q: "Өлеңде 'құл халық' деген тіркес арқылы ақын нені меңзейді?", o: ["Халықтың бейнетке мойынсұнуын", "Қарапайым халықтың еркіндігін", "Малдың халыққа тәуелділігін", "Халықтың рухани байлығын"], a: 0 },
        { q: "Өлеңнің негізгі идеясы неде?", o: ["Мал шаруашылығын дәріптеу", "Білім мен еңбек арқылы халықты ояту", "Құлдықтың пайдасы", "Табиғатты қорғау"], a: 1 },
        { q: "Ақынның адамдарға қарата айтқан негізгі сыны қандай?", o: ["Малдың қадірін білмеуі", "Надандық пен жалқаулық", "Көршімен тату болмауы", "Білімге ұмтылмауы"], a: 1 },
        { q: "Ахмет Байтұрсынұлы қай газеттің редакторы болды?", o: ["Айқап", "Қазақ", "Түркістан уәлаяты", "Серке"], a: 1 },
        { q: "«Құлдарға құлдықтан жоқ артық зейнет» деген жолдағы ақынның ойы?", o: ["Халықтың еркіндігі", "Халықтың сол кездегі мүшкіл халі", "Байлыққа ұмтылу", "Еңбектің пайдасы"], a: 1 },
        { q: "Ахмет Байтұрсынұлының лақап аты?", o: ["Қыр баласы", "Ғалиасқар", "Маса", "Шәріп"], a: 2 },
        { q: "«Адамдық диқаншысы» өлеңіндегі «тұқым» нені білдіреді?", o: ["Бидайды", "Білім мен тағылымды", "Малдың төлін", "Тамырды"], a: 1 },
        { q: "Өлеңнің басты мақсаты?", o: ["Халықты егін егуге шақыру", "Ұлттық сананы ояту", "Мал бағуды үйрету", "Табиғатты суреттеу"], a: 1 }
    ];

    let current = 0;
    let score = 0;
    let userAnswers = []; // Таңдаулар (тек бірінші реттегі дұрыс/бұрыстығы үшін)
    let firstAttemptPerQuestion = true; 
    let timeLeft = 80;
    let timerInterval;
    let locked = false;

    function playSound(type) {
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);
        if (type === 'correct') {
            oscillator.frequency.setValueAtTime(523, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(880, audioCtx.currentTime + 0.1);
        } else {
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(220, audioCtx.currentTime);
            oscillator.frequency.linearRampToValueAtTime(110, audioCtx.currentTime + 0.2);
        }
        gainNode.gain.setValueAtTime(0.05, audioCtx.currentTime);
        oscillator.start(); oscillator.stop(audioCtx.currentTime + 0.3);
    }

    function startQuiz() {
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('quiz-header').style.display = 'flex';
        document.getElementById('controls').style.display = 'flex';
        document.getElementById('progress-container').style.display = 'block';
        renderQuestion();
    }

    function startTimer() {
        clearInterval(timerInterval);
        timeLeft = 80;
        updateTimerDisplay();
        timerInterval = setInterval(() => {
            timeLeft--;
            updateTimerDisplay();
            if (timeLeft <= 0) { clearInterval(timerInterval); handleTimeout(); }
        }, 1000);
    }

    function updateTimerDisplay() {
        const mins = Math.floor(timeLeft / 60);
        const secs = timeLeft % 60;
        const box = document.getElementById('timer-box');
        box.innerText = `${mins.toString().padStart(2,'0')}:${secs.toString().padStart(2,'0')}`;
        box.style.color = timeLeft <= 10 ? '#c0392b' : 'var(--gold)';
    }

    function renderQuestion() {
        locked = false;
        firstAttemptPerQuestion = true;
        const q = questions[current];
        document.getElementById('q-num').innerText = current + 1;
        document.getElementById('progress-fill').style.width = ((current) / questions.length * 100) + '%';
        
        document.getElementById('back-btn').style.visibility = current > 0 ? 'visible' : 'hidden';

        document.getElementById('quiz-view').innerHTML = `
            <div class="question-text">${q.q}</div>
            <div class="options-grid">
                ${q.o.map((opt, i) => `<div class="option" onclick="checkAnswer(${i}, this)">${opt}</div>`).join('')}
            </div>
        `;
        startTimer();
    }

    window.checkAnswer = function(idx, el) {
        if (locked) return;
        const correct = questions[current].a;

        if (idx === correct) {
            locked = true;
            clearInterval(timerInterval);
            el.classList.add('correct');
            playSound('correct');
            
            // Ұпай тек бірінші талпыныстан дұрыс тапқанда беріледі
            if (firstAttemptPerQuestion) {
                score++;
                userAnswers[current] = true;
            } else {
                userAnswers[current] = false;
            }

            setTimeout(() => {
                current++;
                if (current < questions.length) renderQuestion();
                else showResults();
            }, 1200);
        } else {
            // Қате жауап
            el.classList.add('wrong');
            playSound('wrong');
            firstAttemptPerQuestion = false; // Енді бұл сұраққа ұпай берілмейді
        }
    }

    window.goBack = function() {
        if (current > 0) {
            current--;
            // Егер алдыңғы сұрақты бірінші талпыныстан дұрыс тапқан болса, ұпайын қайтару
            if (userAnswers[current] === true) {
                score = Math.max(0, score - 1);
            }
            renderQuestion();
        }
    }

    function handleTimeout() {
        if (locked) return;
        locked = true;
        userAnswers[current] = false;
        const options = document.querySelectorAll('.option');
        options[questions[current].a].classList.add('correct');
        playSound('wrong');
        setTimeout(() => {
            current++;
            if (current < questions.length) renderQuestion();
            else showResults();
        }, 1200);
    }

    function showResults() {
        document.getElementById('quiz-view').style.display = 'none';
        document.getElementById('quiz-header').style.display = 'none';
        document.getElementById('controls').style.display = 'none';
        document.getElementById('progress-container').style.display = 'none';
        document.getElementById('results').style.display = 'block';
        document.getElementById('final-score').innerText = score;
        let msg = score >= 8 ? "Керемет! Сіз Ахмет Байтұрсынұлының мұрасын өте жақсы білесіз!" : 
                  score >= 5 ? "Жақсы нәтиже! Біліміңізді әлі де толықтыруға болады." : 
                  "Шығарманы мұқият қайталап оқып шығуға кеңес береміз.";
        document.getElementById('result-text').innerText = msg;
    }
</script>
</body>
</html>
